var VanillaTilt = (function () { "use strict"; class t { constructor(e, t = {}) { if (!(e instanceof Node)) throw "Can't initialize VanillaTilt because " + e + " is not a Node."; this.width = null, this.height = null, this.clientWidth = null, this.clientHeight = null, this.left = null, this.top = null, this.gammazero = null, this.betazero = null, this.lastgammazero = null, this.lastbetazero = null, this.transitionTimeout = null, this.updateCall = null, this.event = null, this.updateBind = this.update.bind(this), this.resetBind = this.reset.bind(this), this.element = e, this.settings = this.extendSettings(t), this.reverse = this.settings.reverse ? 1 : -1, this.glare = t.glare || this.settings.glare, this.glarePrerender = t["glare-prerender"] || this.settings["glare-prerender"], this.fullPageListening = t["full-page-listening"] || this.settings["full-page-listening"], this.gyroscope = t.gyroscope || this.settings.gyroscope, this.gyroscopeMinAngleX = t.gyroscopeMinAngleX || this.settings.gyroscopeMinAngleX, this.gyroscopeMaxAngleX = t.gyroscopeMaxAngleX || this.settings.gyroscopeMaxAngleX, this.gyroscopeMinAngleY = t.gyroscopeMinAngleY || this.settings.gyroscopeMinAngleY, this.gyroscopeMaxAngleY = t.gyroscopeMaxAngleY || this.settings.gyroscopeMaxAngleY, this.gyroscopeSamples = t.gyroscopeSamples || this.settings.gyroscopeSamples, this.elementListener = this.getElementListener(), this.glare && (this.prepareGlare(), this.glarePrerender || (this.addGlare = this.addGlare.bind(this), this.removeGlare = this.removeGlare.bind(this), this.element.addEventListener("mouseenter", this.addGlare), this.element.addEventListener("mouseleave", this.removeGlare))), this.fullPageListening ? window.addEventListener("mousemove", this.updateBind) : this.elementListener.addEventListener("mousemove", this.updateBind), this.elementListener.addEventListener("mouseleave", this.resetBind), this.glare && (this.element.style.transformStyle = "preserve-3d"), this.element.style.willChange = "transform", this.element.style.transform = "perspective(" + this.settings.perspective + "px) rotateX(0deg) rotateY(0deg)", this.gyroscope && (this.onDeviceOrientationBind = this.onDeviceOrientation.bind(this), window.addEventListener("deviceorientation", this.onDeviceOrientationBind)), this.settings.startX && this.settings.startY && (this.element.style.transform = "perspective(" + this.settings.perspective + "px) rotateX(" + this.settings.startX + "deg) rotateY(" + this.settings.startY + "deg) scale3d(1, 1, 1)"), this.settings.scale && (this.element.style.transform += " scale3d(" + this.settings.scale + ", " + this.settings.scale + ", 1)") } getElementListener() { if (this.fullPageListening) return window; if ("string" == typeof this.settings["mouse-event-element"]) { const e = document.querySelector(this.settings["mouse-event-element"]); if (e) return e } return this.element.parentElement instanceof Node ? this.element.parentElement : this.element } addGlare() { this.glareElement.style.transform = "rotate(180deg) translate(-50%, -50%)", this.glareElement.style.opacity = "0" } removeGlare() { this.glareElement.style.opacity = "0" } prepareGlare() { if (!this.glarePrerender) { const e = document.createElement("div"); e.classList.add("js-tilt-glare"); const t = document.createElement("div"); t.classList.add("js-tilt-glare-inner"), e.appendChild(t), this.element.appendChild(e) } this.glareElementWrapper = this.element.querySelector(".js-tilt-glare"), this.glareElement = this.element.querySelector(".js-tilt-glare-inner"), this.glareElementWrapper && (Object.assign(this.glareElementWrapper.style, { position: "absolute", top: "0", left: "0", width: "100%", height: "100%", overflow: "hidden", "pointer-events": "none" }), Object.assign(this.glareElement.style, { position: "absolute", top: "50%", left: "50%", "pointer-events": "none", "background-image": `linear-gradient(0deg, rgba(255,255,255,0) 0%, rgba(255,255,255,1) 100%)`, width: `${2 * this.element.offsetWidth}px`, height: `${2 * this.element.offsetWidth}px`, transform: "rotate(180deg) translate(-50%, -50%)", "transform-origin": "0% 0%", opacity: "0" })) } update(e) { if (this.event = e, this.updateCall) return; this.updateCall = requestAnimationFrame(this.updateBind) } reset() { this.event = { clientX: this.left + this.width / 2, clientY: this.top + this.height / 2 }, this.element && this.element.style && (this.element.style.transform = `perspective(${this.settings.perspective}px) rotateX(0deg) rotateY(0deg) scale3d(1, 1, 1)`), this.resetGlare(), this.element.dispatchEvent(new CustomEvent("tiltChange", { detail: { tiltX: 0, tiltY: 0, percentageX: 50, percentageY: 50, angle: 0 } })), this.updateCall = null } resetGlare() { this.glare && (this.glareElement.style.transform = "rotate(180deg) translate(-50%, -50%)", this.glareElement.style.opacity = "0") } destroy() { clearTimeout(this.transitionTimeout), null !== this.updateCall && cancelAnimationFrame(this.updateCall), this.reset(), this.elementListener.removeEventListener("mousemove", this.updateBind), this.elementListener.removeEventListener("mouseleave", this.resetBind), this.glare && (this.element.removeEventListener("mouseenter", this.addGlare), this.element.removeEventListener("mouseleave", this.removeGlare)), this.gyroscope && window.removeEventListener("deviceorientation", this.onDeviceOrientationBind), this.element.vanillaTilt = null, delete this.element.vanillaTilt, this.element = null } onDeviceOrientation(e) { if (null === e.gamma || null === e.beta) return; this.updateElementPosition(); const t = this.settings.gyroscopeSamples, i = this.settings.gyroscopeMinAngleX, s = this.settings.gyroscopeMaxAngleX, n = this.settings.gyroscopeMinAngleY, l = this.settings.gyroscopeMaxAngleY, a = this.settings.gyroscopeFrequency, r = this.settings.gyroscopeAlpha, o = e.gamma, h = e.beta; null === this.gammazero && (this.gammazero = o, this.betazero = h); const c = o - this.gammazero, d = h - this.betazero, u = c; const m = d; const g = Math.max(Math.min(u, s), i), p = Math.max(Math.min(m, l), n), v = (g - i) / (s - i), f = (p - n) / (l - n); null !== this.updateCall && cancelAnimationFrame(this.updateCall), this.event = { clientX: this.left + this.width * v, clientY: this.top + this.height * f }, this.updateCall = requestAnimationFrame(this.updateBind) } updateElementPosition() { const e = this.element.getBoundingClientRect(); this.width = this.element.offsetWidth, this.height = this.element.offsetHeight, this.left = e.left, this.top = e.top } extendSettings(e) { let t = { reverse: !1, max: 15, startX: 0, startY: 0, perspective: 1000, easing: "cubic-bezier(.03,.98,.52,.99)", scale: 1, speed: 300, transition: !0, axis: null, glare: !1, "max-glare": 1, "glare-prerender": !1, "full-page-listening": !1, "mouse-event-element": null, reset: !0, gyroscope: !0, gyroscopeMinAngleX: -45, gyroscopeMaxAngleX: 45, gyroscopeMinAngleY: -45, gyroscopeMaxAngleY: 45, gyroscopeSamples: 10 }; if (Object.assign(t, e), t) return t } static init(e, t) { e instanceof Node && (e = [e]), e instanceof NodeList && (e = [].slice.call(e)), e.forEach(e => { "vanillaTilt" in e || (e.vanillaTilt = new t(e, t)) }) } } return "undefined" != typeof document && (window.VanillaTilt = t, t.init(document.querySelectorAll("[data-tilt]"))), t })();
